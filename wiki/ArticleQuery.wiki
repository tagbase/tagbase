#summary How to construct your query

<wiki:toc max_depth="2" />

= Introduction =

Query is a powerful way to interact with your data in any databases. Query utilizes a standard coding language known as structured query language (*[http://www.w3schools.com/sql/default.asp SQL]*) that are universal across platforms. The beauty about query is that you don't have to know any SQL syntax at all to construct your own query. Many software, like MS Access which Tagbase uses, provide a graphical interface (e.g. [http://www.eraserve.com/tutorials/MSACCESS_Queries.asp Query Builder]) for you to create query without typing a single line of code. What's more is that in Tagbase, you can do formulae or use functions just like you do in MS Excel. You can even do an Excel-style [http://www.databasedev.co.uk/crosstab_queries.html pivot table query] in Access.

We will run through a set of queries to illustrate how you can interrogate your data

= Accessing the Query Builder/ Query Designer = 
 
  * For Access 2003 and below, go to *Queries* under *Objects*. Click on the *Design* button.
  
  * For Access 2007 or above, go to the *Create* tab. Click *Query Design* to start the builder.
  
http://tagbase.googlecode.com/svn/trunk/images/Query2007a.jpg

= To follow along... =

  * Make sure you have imported the sample dataset. Refer to the *StarterKit* to help you achieve that.

  * To keep it simple, our example only has 1 fish with time series data in the database. 
  
  * You may also want to revisit the data model in Tagbase to facilitate you locating all the information you need. See *[ArticleTables Data tables and Relationships] for details.

= Examples = 

== Query 1 - Extract time series data during a specific month  ==

This example demonstrates how to you can filter your data. 

 * Create a new query by clicking the *Design* button (or *New* > *Design View* > *Ok* in older versions)
 * A *Show Table* dialog appears, stay in the default *Tables* tab
 * Scroll down the list to click and highlight the table, `Proc_Archival_TempLight`. Click *Add*
 * The fields of the `Proc_Archival_TempLight` table are exposed in the Query Designer, scroll or resize the mini-window to see them
 * Click/ double-click on the asterick `*` at the top to add all fields to your query. The asterick is a wildcard operator that means "Select All"
 * Next, click/ double-click on the `DateTime` field to add it to the query. We will use this as our filter
 * Apply a function, `Month` such that we only extract the month part of `DateTime`. To apply this function, type the following:
 `Month([DateTime])`
 
  {{{ 
Tips -
Use a set of square brackets [ ] to denote a field name in functions or queries. 
This is particularly useful when a field name has spaces or special characters,
even though such naming convention is not recommended.
 }}}
 
 * You can nickname (use an alias) your field, for example, since we will filter data out for the month of July, we write out our function as follows:
 `July: Month([DateTime])`
 
 * Type in the *Criteria*, 7, as our filter to get data from July
 * Hit the exclamation mark ! button (*Run*) to see the results
 
 * Use *[http://office.microsoft.com/en-us/access-help/examples-of-query-criteria-HA010066611.aspx these examples of query criteria]* provided by Microsoft Office to help you master filtering by criteria. For example, filtering by dates will need to bound a date with hash sign #, and take the form of 
 
 ` Between #1/1/2007# And #12/31/2007#
 

== Query 2 - Summarize the daily maximum depth of a fish  ==

We build upon the previous example and summarize your data as aggregated values (average, min or max).

== Query 3 - Extract the temperature experienced when a fish reached its daily maximum depth ==

We again use the previous example and apply the query as a constraint to extract data

== Query 4 - Associated our extract fish data with metadata ==

Our final example shows how you can add metadata to your extract data for an informative presentation

== Further examples ==

It is worthwhile to visit the link below or search over the web to check out more general examples. You will appreciate the power of databases and queries as you learn more about queries.

http://www.databasedev.co.uk/queries.html